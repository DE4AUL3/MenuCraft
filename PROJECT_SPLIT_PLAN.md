# План разделения MenuCraft на два проекта

## Общая архитектура

### Текущее состояние
- Единый Next.js проект с админ-панелью на `/admin`
- Общие компоненты, типы и утилиты
- Единая база данных (localStorage/JSON)
- Единый деплой на Vercel

### Целевая архитектура
```
MenuCraft Ecosystem
├── menucraft-frontend/     # Клиентское приложение
├── menucraft-admin/        # Админ-панель
└── menucraft-shared/       # Общие типы и утилиты
```

## 1. Frontend Project (menucraft-frontend)

### Структура проекта
```
menucraft-frontend/
├── src/
│   ├── app/
│   │   ├── page.tsx                    # Выбор ресторана
│   │   ├── restaurant/[id]/page.tsx    # Страница ресторана
│   │   ├── menu/[id]/page.tsx         # Страница меню
│   │   ├── category/[id]/page.tsx     # Категория блюд
│   │   ├── cart/page.tsx              # Корзина
│   │   └── qr/page.tsx                # QR-код страница
│   ├── components/
│   │   ├── Restaurant/                # Компоненты ресторанов
│   │   ├── Menu/                      # Компоненты меню
│   │   ├── Cart/                      # Компоненты корзины
│   │   └── ui/                        # UI компоненты
│   ├── hooks/
│   │   ├── useCart.tsx
│   │   ├── useLanguage.ts
│   │   └── useTheme.ts
│   └── lib/
│       ├── api.ts                     # API клиент
│       └── utils.ts
├── public/                            # Статичные файлы
└── package.json
```

### Основные функции
- Просмотр каталога ресторанов
- Просмотр меню ресторанов
- Добавление в корзину
- Оформление заказа
- QR-код интеграция
- PWA функциональность
- Мультиязычность
- Темы оформления

### Технологии
- Next.js 15.5.3
- TypeScript
- Tailwind CSS
- React Query (для API)
- Local Storage (кэш)

## 2. Admin Project (menucraft-admin)

### Структура проекта
```
menucraft-admin/
├── src/
│   ├── app/
│   │   ├── login/page.tsx             # Авторизация
│   │   ├── dashboard/page.tsx         # Дашборд
│   │   ├── restaurants/page.tsx       # Управление ресторанами
│   │   ├── menu/page.tsx             # Управление меню
│   │   ├── orders/page.tsx           # Управление заказами
│   │   ├── analytics/page.tsx        # Аналитика
│   │   └── settings/page.tsx         # Настройки
│   ├── components/
│   │   ├── Dashboard/                # Дашборд компоненты
│   │   ├── Restaurant/               # Управление ресторанами
│   │   ├── Menu/                     # Управление меню
│   │   ├── Orders/                   # Управление заказами
│   │   ├── Analytics/                # Аналитика
│   │   └── ui/                       # UI компоненты
│   ├── hooks/
│   │   ├── useAuth.ts
│   │   ├── useAnalytics.ts
│   │   └── useNotifications.ts
│   └── lib/
│       ├── api.ts                    # API клиент
│       ├── auth.ts                   # Авторизация
│       └── utils.ts
├── public/                           # Статичные файлы
└── package.json
```

### Основные функции
- Авторизация и управление доступом
- Управление ресторанами
- Управление меню и категориями
- Управление заказами
- Аналитика и отчеты
- Настройки системы
- Уведомления

### Технологии
- Next.js 15.5.3
- TypeScript
- Tailwind CSS
- React Query (для API)
- React Hook Form
- Recharts (аналитика)
- NextAuth.js (авторизация)

## 3. Shared Package (menucraft-shared)

### Структура пакета
```
menucraft-shared/
├── src/
│   ├── types/
│   │   ├── restaurant.ts             # Типы ресторанов
│   │   ├── menu.ts                   # Типы меню
│   │   ├── order.ts                  # Типы заказов
│   │   ├── analytics.ts              # Типы аналитики
│   │   └── index.ts                  # Экспорт всех типов
│   ├── constants/
│   │   ├── api.ts                    # API endpoints
│   │   ├── themes.ts                 # Темы оформления
│   │   └── languages.ts              # Языки
│   ├── utils/
│   │   ├── validation.ts             # Валидация данных
│   │   ├── formatting.ts             # Форматирование
│   │   └── helpers.ts                # Общие утилиты
│   └── index.ts                      # Главный экспорт
├── package.json
└── tsconfig.json
```

### Экспортируемые элементы
- TypeScript типы и интерфейсы
- Константы и конфигурации
- Утилиты валидации и форматирования
- API схемы и endpoints

## 4. API и данные

### Backend API
```
api/
├── restaurants/
│   ├── GET /restaurants              # Список ресторанов
│   ├── GET /restaurants/:id          # Ресторан по ID
│   ├── POST /restaurants             # Создать ресторан
│   ├── PUT /restaurants/:id          # Обновить ресторан
│   └── DELETE /restaurants/:id       # Удалить ресторан
├── menu/
│   ├── GET /menu/:restaurantId       # Меню ресторана
│   ├── POST /menu/:restaurantId      # Добавить блюдо
│   ├── PUT /menu/:restaurantId/:id   # Обновить блюдо
│   └── DELETE /menu/:restaurantId/:id # Удалить блюдо
├── orders/
│   ├── GET /orders                   # Список заказов
│   ├── POST /orders                  # Создать заказ
│   ├── PUT /orders/:id               # Обновить статус
│   └── GET /orders/analytics         # Аналитика заказов
└── auth/
    ├── POST /auth/login              # Авторизация админа
    ├── POST /auth/logout             # Выход
    └── GET /auth/me                  # Текущий пользователь
```

### База данных
- **Вариант 1:** Продолжить с localStorage + JSON файлы
- **Вариант 2:** Перейти на PostgreSQL + Prisma
- **Вариант 3:** Использовать Supabase для простоты

## 5. Деплой стратегия

### Frontend (menucraft-frontend)
- **Домен:** `menucraft.vercel.app` (главный)
- **Платформа:** Vercel
- **URL структура:**
  - `/` - выбор ресторана
  - `/restaurant/:id` - страница ресторана
  - `/menu/:id` - меню ресторана

### Admin (menucraft-admin)
- **Домен:** `admin.menucraft.vercel.app` (поддомен)
- **Платформа:** Vercel
- **URL структура:**
  - `/` - дашборд
  - `/restaurants` - управление ресторанами
  - `/orders` - управление заказами

### Shared Package
- **Платформа:** npm registry (private)
- **Версионирование:** semantic versioning
- **Автоматическая публикация:** через GitHub Actions

## 6. Миграция план

### Этап 1: Подготовка
1. Создать `menucraft-shared` пакет
2. Вынести общие типы и утилиты
3. Настроить сборку и публикацию

### Этап 2: Frontend проект
1. Создать новый Next.js проект
2. Установить `menucraft-shared`
3. Перенести клиентские компоненты
4. Настроить API клиент
5. Протестировать функциональность

### Этап 3: Admin проект
1. Создать новый Next.js проект
2. Установить `menucraft-shared`
3. Перенести админ компоненты
4. Добавить авторизацию
5. Настроить API клиент

### Этап 4: API и данные
1. Определить API endpoints
2. Настроить общую базу данных
3. Создать API роуты в обоих проектах
4. Синхронизация данных

### Этап 5: Деплой
1. Настроить CI/CD для всех проектов
2. Деплой на разные домены
3. Настройка CORS и безопасности
4. Мониторинг и логирование

## 7. Преимущества разделения

### Производительность
- Меньший размер бандла для каждого приложения
- Быстрая загрузка клиентской части
- Независимое кэширование

### Разработка
- Независимые команды разработки
- Отдельные циклы релизов
- Изолированное тестирование

### Безопасность
- Разделение доступов
- Изолированная админ-панель
- Отдельная авторизация

### Масштабирование
- Независимое масштабирование
- Разные требования к ресурсам
- Гибкость в выборе технологий

## 8. Следующие шаги

1. **Создать shared пакет** с общими типами
2. **Настроить infrastructure** для деплоя
3. **Создать frontend проект** с основной функциональностью
4. **Создать admin проект** с управлением
5. **Протестировать интеграцию** между проектами
6. **Деплой и мониторинг** производственной среды

---

**Временные рамки:** 2-3 недели разработки
**Команда:** 1-2 разработчика
**Риски:** Синхронизация данных, API совместимость
**Митигация:** Постепенная миграция, обширное тестирование